/*!CK:3976848963!*//*1380635299,173224501*/

if (self.CavalryLogger) { CavalryLogger.start_js(["cWPjX"]); }

__d("BuddyListNub",["Arbiter","AvailableList","BlackbirdUpsell","ChannelConnection","ChannelConstants","ChatConfig","ChatSidebar","ChatVisibility","CSS","Dock","DOM","Event","HTML","JSXDOM","KeyEventController","Keys","NubController","OrderedFriendsList","Parent","PresencePrivacy","Toggler","csx","cx","tx"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AvailableList'),i=b('BlackbirdUpsell'),j=b('ChannelConnection'),k=b('ChannelConstants'),l=b('ChatConfig'),m=b('ChatSidebar'),n=b('ChatVisibility'),o=b('CSS'),p=b('Dock'),q=b('DOM'),r=b('Event'),s=b('HTML'),t=b('JSXDOM'),u=b('KeyEventController'),v=b('Keys'),w=b('NubController'),x=b('OrderedFriendsList'),y=b('Parent'),z=b('PresencePrivacy'),aa=b('Toggler'),ba=b('csx'),ca=b('cx'),da=b('tx'),ea=32,fa=10;for(var ga in w)if(w.hasOwnProperty(ga))ia[ga]=w[ga];var ha=w===null?null:w.prototype;ia.prototype=Object.create(ha);ia.prototype.constructor=ia;ia.__superConstructor__=w;function ia(ja,ka,la){w.call(this);ha.init.call(this,ja);this.root=ja;this.orderedList=ka;this.typeahead=la;this.button=q.find(ja,'a.fbNubButton');this.unreadCount=q.find(ja,"span._5ayx");this.label=q.find(ja,'span.label');this.body=q.scry(ja,'div.fbNubFlyoutBody')[0];this.container=y.byClass(ja,"_56ox");var ma=q.find(ja,'div.fbNubFlyoutTitlebar');aa.createInstance(ma).setSticky(false);ka.subscribe('render',this.flyoutContentChanged.bind(this));ka.setScrollContainer(this.body);h.subscribe('buddylist/availability-changed',this._updateCount.bind(this));g.subscribe('chat/connect',this._handleConnect.bind(this));z.subscribe('privacy-user-presence-changed',this._handleVisibilityChange.bind(this));this.message=q.find(ja,"div._4mq1");this.warningMsgText=null;this.warningMsgEventListener=null;this.showWarningTimeout=null;j.subscribe(j.CONNECTED,this._handleChannelConnected.bind(this));j.subscribe(j.SHUTDOWN,this._handleChannelShutdown.bind(this));j.subscribe(j.RECONNECTING,this._handleChannelReconnecting.bind(this));j.subscribe([j.MUTE_WARNING,j.UNMUTE_WARNING],this._updateView.bind(this));this.subscribe('show',this.onShow.bind(this));this.subscribe('hide',this.onHide.bind(this));this.subscribe('resize',this.onResize.bind(this));r.listen(ja,'keydown',this._onKeyDown.bind(this));r.listen(this.button,'click',this.onButtonClick.bind(this));u.registerKey('q',function(event){if(this._isOpen){la.getCore().getElement().focus();}else{this.onButtonClick();this.show();}event.prevent();}.bind(this));la.getCore().subscribe('escape',this.hide.bind(this));la.subscribe(['respond','reset'],function(na,oa){if(this._isOpen){var pa=this.orderedList.isVisible();if(oa&&oa.value&&oa.value===la.getCore().getValue()&&la.getView().isVisible()){p.setUseMaxHeight(this.root,false);this.orderedList.hide();}else this._showBuddyList();if(pa!==this.orderedList.isVisible())this.flyoutContentChanged();}}.bind(this));g.subscribe('sidebar/show',this.hide.bind(this));g.subscribe('sidebar/hide',this._onSidebarHide.bind(this));if(l.get('litestand_buddylist_count')){this._unreadMessageCount=0;g.subscribe('buddylist-nub/updateCount',function(na,oa){if(this._unreadMessageCount!==oa.count){this._unreadMessageCount=oa.count;this._updateView();}}.bind(this));}this._orderedListCount=x.getList().length;g.inform('buddylist-nub/initialized',this,g.BEHAVIOR_PERSISTENT);this._handleVisibilityChange();}ia.prototype.getButton=function(){return this.button;};ia.prototype.getRoot=function(){return this.root;};ia.prototype._handleConnect=function(ja){this._updateView(true);};ia.prototype._getShutdownReason=function(ja){switch(ja){case k.HINT_AUTH:return "Sesja wygas\u0142a. Zaloguj si\u0119 ponownie.";case k.HINT_CONN:return da._("{Chat} Facebooka jest obecnie niedost\u0119pny.",{Chat:"Czat"});case k.HINT_MAINT:return da._("{Chat} Facebooka jest obecnie poddawany czynno\u015bciom konserwacyjnym.",{Chat:"Czat"});default:return da._("{Chat} Facebooka jest obecnie niedost\u0119pny.",{Chat:"Czat"});}};ia.prototype._getReconnectMsg=function(ja){var ka;if(ja===null){ka="Nie mo\u017cna po\u0142\u0105czy\u0107 z czatem. Sprawd\u017a po\u0142\u0105czenie z internetem.";}else if(ja>l.get('warning_countdown_threshold_msec')){var la=q.create('a',{href:'#',className:'fbChatReconnectLink'},"Spr\u00f3buj ponownie"),ma=q.create('div',null,la),na=ma.innerHTML;ka=s(da._("Nie mo\u017cna po\u0142\u0105czy\u0107 z czatem. {try-again-link}",{'try-again-link':na}));}else if(ja>1000){ka=da._("Nie mo\u017cna po\u0142\u0105czy\u0107 z czatem. Pr\u00f3ba ponownego nawi\u0105zania po\u0142\u0105czenia za {seconds} sekund...",{seconds:Math.floor(ja/1000)});}else ka="Nie mo\u017cna po\u0142\u0105czy\u0107 z czatem. Pr\u00f3ba ponownego nawi\u0105zania po\u0142\u0105czenia...";return ka;};ia.prototype._resetShowWarningTimeout=function(){if(this.showWarningTimeout){clearTimeout(this.showWarningTimeout);this.showWarningTimeout=null;}};ia.prototype._handleChannelConnected=function(ja){this._resetShowWarningTimeout();if(this.orderedList.isVisible())n.goOnline();this.warningMsgText=null;this._updateView();};ia.prototype._handleChannelShutdown=function(ja,ka){this._resetShowWarningTimeout();this.warningMsgText=this._getShutdownReason(ka);this._updateView();};ia.prototype._handleChannelReconnecting=function(ja,ka){this._resetShowWarningTimeout();this.warningMsgText=this._getReconnectMsg(ka);if(ka>1000){if(ka>l.get('warning_countdown_threshold_msec')){if(this.warningMsgEventListener){this.warningMsgEventListener.remove();this.warningMsgEventListener=null;}this.warningMsgEventListener=r.listen(this.message,'click',function(event){if(o.hasClass(event.getTarget(),'fbChatReconnectLink')){this._tryReconnect();event.kill();}}.bind(this));}this.showWarningTimeout=setTimeout(this._handleChannelReconnecting.bind(this,ja,ka-1000),1000,false);}this._updateView();};ia.prototype._tryReconnect=function(){if(j.disconnected())j.reconnect();};ia.prototype._handleVisibilityChange=function(){this._updateView();if(i.shouldShow()){if(n.hasBlackbirdEnabled()){i.showBlackbirdDialog(this.getButton(),z.getVisibility());}else if(!n.isOnline())i.showOfflineDialog(this.getButton());}else i.hide();if(!n.isOnline())this.hide();};ia.prototype._updateView=function(ja){var ka=this.container;if(ka){o.conditionClass(ka,'offline',!n.isOnline());o.conditionClass(ka,'error',j.disconnected());}if(j.disconnected())q.setContent(this.message,this.warningMsgText);var la,ma;if(!n.isOnline()){la=da._("{Chat} (Wy\u0142\u0105czony)",{Chat:"Czat"});}else if(j.disconnected()){la=da._("{Chat} (roz\u0142\u0105czono)",{Chat:"Czat"});}else{var na=h.getOnlineCount();if(na){la=da._("{Chat} {number-available}",{Chat:"Czat",'number-available':t.span({className:"count"}," (",na,") ")});}else{la="Czat";ma=true;}}this._setUnread(this._unreadMessageCount);this._setLabel(la,ma);this.buttonContentChanged();};ia.prototype.onButtonClick=function(){this._conditionallyShowTypeahead();if(o.shown(this.typeahead.getElement())){var ja=this.subscribe('show',function(){this.typeahead.getCore().getElement().focus();i.dismiss();}.bind(this));this.unsubscribe.bind(this,ja).defer();}};ia.prototype.onHide=function(){this._isOpen=false;if(this._buddyListRenderSubscription){this.orderedList.unsubscribe(this._buddyListRenderSubscription);this._buddyListRenderSubscription=null;}this.orderedList.hide();this.typeahead.getCore().reset();};ia.prototype._onKeyDown=function(event){var ja=r.getKeyCode(event);if(ja===v.ESC&&!o.hasClass(this.root,'menuOpened')){this.hide();return false;}else if(ja==v.RETURN)m.enable();};ia.prototype._onSidebarHide=function(event){this.getButton().focus();};ia.prototype.onResize=function(){var ja=p.getMaxFlyoutHeight(this.root)-60,ka=Math.max(250,ja);this.orderedList.setNumTopFriends(Math.floor(ka/ea));};ia.prototype._showBuddyList=function(){if(!this._buddyListRenderSubscription)this._buddyListRenderSubscription=this.orderedList.subscribe('render',p.setUseMaxHeight.bind(p,this.root,false));this.orderedList.show();};ia.prototype.onShow=function(){this._isOpen=true;if(j.disconnected()){this._tryReconnect();this._showBuddyList();}else n.goOnline(this._showBuddyList.bind(this));};ia.prototype._setLabel=function(ja,ka){var la=this.label.cloneNode(true);q.setContent(la,ja);q.replace(this.label,la);this.label=la;this.throbber&&o.conditionShow(this.throbber,!!ka);};ia.prototype._setUnread=function(ja){o.conditionShow(this.unreadCount,!!ja);if(ja){ja=t.span({className:"_51jx _5ayw"},ja);q.setContent(this.unreadCount,ja);}};ia.prototype._conditionallyShowTypeahead=function(){o.conditionShow(this.typeahead.getElement(),this._orderedListCount>=fa);};ia.prototype._updateCount=function(){this._updateView();this._conditionallyShowTypeahead();};e.exports=ia;});
__d("ChatSidebarDropdown",["Arbiter","AsyncRequest","Chat","ChatOptions","ChatVisibility","CSS","DOM","Event","JSLogger","PresenceState","SelectorDeprecated"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AsyncRequest'),i=b('Chat'),j=b('ChatOptions'),k=b('ChatVisibility'),l=b('CSS'),m=b('DOM'),n=b('Event'),o=b('JSLogger'),p=b('PresenceState'),q=b('SelectorDeprecated');function r(s,t){this._root=s;this._logger=o.create('blackbird');this._displayBrowserNotificationsIfNeeded();q.listen(s,'select',this._onSelect.bind(this));q.listen(s,'toggle',this._onToggle.bind(this));if(t){q.listen(s,'close',t.allowCollapse.curry(true,'SidebarMenu'));q.listen(s,'open',t.allowCollapse.curry(false,'SidebarMenu'));}g.subscribe('chat/option-changed',this._onOptionChanged.bind(this));}r.prototype.changeSetting=function(s,t){if(this._pendingChange)return false;this._pendingChange=true;var u={};u[s]=t;j.setSetting(s,t,'sidebar_menu');new h('/ajax/chat/settings.php').setHandler(this._onChangeSettingResponse.bind(this,s,t)).setErrorHandler(this._onChangeSettingError.bind(this,s,t)).setFinallyHandler(this._onChangeFinally.bind(this)).setData(u).setAllowCrossPageTransition(true).send();};r.prototype._displayBrowserNotificationsIfNeeded=function(){if(window.webkitNotifications){m.scry(document,'li.sidebar-browser-notif').forEach(l.show);if(window.webkitNotifications.checkPermission()!==0)m.scry(document,'li.sidebar-browser-notif').forEach(function(s){l.removeClass(s,'checked');});}};r.prototype._conditionEnabled=function(s,t){var u=q.getOption(this._root,s);u&&q.setOptionEnabled(u,t);};r.prototype._onChangeSettingResponse=function(s,t,u){p.doSync();};r.prototype._onChangeSettingError=function(s,t,u){j.setSetting(s,!t,'sidebar_menu_error');};r.prototype._onChangeFinally=function(){this._pendingChange=false;};r.prototype._onOptionChanged=function(s,t){var u=t.name,v=t.value;if(u==='sound'||u==='browser_notif'){var w=q.getOption(this._root,u);if(v!==q.isOptionSelected(w))q.setSelected(this._root,u,v);}};r.prototype._onSelect=function(s){if(this._pendingChange)return false;var t=false,u=false,v=q.getOptionValue(s.option);switch(v){case 'sidebar':return this.toggleSidebar();case 'online':if(!k.isOnline()){k.goOnline();}else u=true;t=true;break;case 'offline':if(k.isOnline()){k.goOffline();}else u=true;t=true;break;case 'advanced_settings':case 'turn_off_dialog':g.inform('chat/advanced-settings-dialog-opened');t=true;break;}if(u){this._logger.error('sidebar_dropdown_visibility_error',{action:v});}else this._logger.log('sidebar_dropdown_set_visibility',{action:v});if(t){q.toggle(this._root);return false;}};r.prototype._onToggle=function(s){if(this._pendingChange)return false;var t=q.getOptionValue(s.option),u=q.isOptionSelected(s.option);switch(t){case 'visibility':if(!k){this._jslogger.error('on_toggle_visibility_undefined');return;}k.toggleVisibility();this._logger.log('sidebar_dropdown_toggle_visibility',{available:u});break;case 'browser_notif':if(u&&window.webkitNotifications&&window.webkitNotifications.checkPermission()!==0){window.webkitNotifications.requestPermission(function(){this.changeSetting(t,u);}.bind(this));}else this.changeSetting(t,u);break;case 'sound':this.changeSetting(t,u);break;}q.toggle(this._root);};r.prototype._onVisibilityChanged=function(){var s=k.isOnline(),t=q.getOption(this._root,'visibility');if(s!==q.isOptionSelected(t))q.setSelected(this._root,'visibility',s);};r.prototype.toggleSidebar=function(){i.toggleSidebar();q.toggle(this._root);return false;};r.registerEditFavorites=function(s,t,u,v){function w(x){l.conditionShow(s,!x);l.conditionShow(t,x);}n.listen(s,'click',function(){u.toggleEditMode();w(true);q.toggle(v);});n.listen(t,'click',function(){u.toggleEditMode();w(false);q.toggle(v);});u.subscribe('editStart',w.curry(true));u.subscribe('editEnd',w.curry(false));};e.exports=r;});
__d("NotificationImpressions",["AsyncSignal","NotificationTokens","URI"],function(a,b,c,d,e,f){var g=b('AsyncSignal'),h=b('NotificationTokens'),i=b('URI'),j='/ajax/notifications/impression.php';function k(l,m){var n={ref:m};h.untokenizeIDs(l).forEach(function(o,p){n['alert_ids['+p+']']=o;});new g(i(j).getQualifiedURI().toString(),n).send();}e.exports={log:k};});
__d("NotificationBeeperItemContents.react",["Animation","CloseButton.react","ImageBlock.react","NotificationURI","NotificationUserActions","React","TextWithEntities.react","Timestamp.react","cx"],function(a,b,c,d,e,f){var g=b('Animation'),h=b('CloseButton.react'),i=b('ImageBlock.react'),j=b('NotificationURI'),k=b('NotificationUserActions'),l=b('React'),m=b('TextWithEntities.react'),n=b('Timestamp.react'),o=b('cx');function p(r,s){return l.DOM.span({className:"fwb"},r);}var q=l.createClass({displayName:'NotificationBeeperItemContents',_markAsRead:function(){k.markNotificationsAsRead([this.props.beep.notificationID]);this.props.onHide();},_onClose:function(){this._markAsRead();this.props.onHide();},_doFlash:function(){new g(this.refs.inner.getDOMNode()).from('opacity','0').to('opacity','1').duration(200).go();},componentDidUpdate:function(r){if(r.beep.beepID!==this.props.beep.beepID)this._doFlash();},render:function(){var r=this.props.beep,s=r.icon.uri,t=r.link?j.localize(r.link):'#',u=r.photo&&j.snowliftable(t),v=u?t:r.ajaxifyLink,w=u?'theater':(v?'dialog':null);return (l.DOM.div({ref:"inner"},h({className:"_3soc",onClick:this._onClose,size:"medium"}),l.DOM.a({href:t,ajaxify:v,onClick:this._markAsRead,rel:w,className:"_3soi"},i({className:"_3soj"},l.DOM.img({src:r.actors[0].profile_picture.uri,className:"_3sok"}),l.DOM.div({className:"_3sol"},m({renderEmoticons:true,renderEmoji:true,interpolator:p,ranges:r.text.ranges,aggregatedranges:r.text.aggregated_ranges,text:r.text.text}),i({className:"_3som"},l.DOM.img({src:s}),n({time:r.timestamp.time,text:r.timestamp.text,verbose:r.timestamp.verbose})))))));}});e.exports=q;});
__d("NotificationBeeperItem.react",["Animation","BrowserSupport","NotificationBeeperItemContents.react","React","cx","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f){var g=b('Animation'),h=b('BrowserSupport'),i=b('NotificationBeeperItemContents.react'),j=b('React'),k=b('cx'),l=b('setTimeoutAcrossTransitions'),m=j.createClass({displayName:'NotificationBeeperItem',getInitialState:function(){return {fadedIn:false,hidden:false};},componentDidMount:function(){var n;if(h.hasCSSAnimations()){n=this.setState.bind(this,{fadedIn:true},null);}else n=function(){new g(this.refs.item.getDOMNode()).from('top','-30px').from('opacity','0').to('top','0px').to('opacity','1').duration(200).ondone(this.setState.bind(this,{fadedIn:true},null)).go();}.bind(this);l(n,50);this.props.onInserted(this.props.beep);},_onHide:function(){this.setState({hidden:true});},render:function(){var n=this.props.beep,o=(("_3sod")+(this.state.fadedIn?' '+"_3soe":'')+(this.state.hidden?' '+"_3sof":'')),p=n.beepRenderer||i;return (j.DOM.li({className:o,ref:"item",'data-gt':n.tracking},p({beep:n,onHide:this._onHide})));}});e.exports=m;});
__d("NotificationSound",["Sound","copyProperties"],function(a,b,c,d,e,f){var g=b('Sound'),h=b('copyProperties'),i=5000;g.init(['audio/mpeg']);function j(k){this._soundPath=k;this._lastPlayed=0;}h(j.prototype,{play:function(k){if(!this._soundPath)return;var l=Date.now();if((l-this._lastPlayed)<i)return;this._lastPlayed=l;g.play(this._soundPath,k);}});e.exports=j;});
__d("NotificationBeeper.react",["Animation","Arbiter","ChannelConstants","NotificationBeeperItem.react","NotificationConstants","NotificationImpressions","NotificationPhotoThumbnail","NotificationSound","NotificationUpdates","NotificationUserActions","React","Style","cx","isEmpty","merge","setTimeoutAcrossTransitions","shield"],function(a,b,c,d,e,f){var g=b('Animation'),h=b('Arbiter'),i=b('ChannelConstants'),j=b('NotificationBeeperItem.react'),k=b('NotificationConstants'),l=b('NotificationImpressions'),m=b('NotificationPhotoThumbnail'),n=b('NotificationSound'),o=b('NotificationUpdates'),p=b('NotificationUserActions'),q=b('React'),r=b('Style'),s=b('cx'),t=b('isEmpty'),u=b('merge'),v=b('setTimeoutAcrossTransitions'),w=b('shield'),x=10000,y=4000,z='beeper',aa=k.PayloadSourceType.LIVE_SEND,ba=k.PayloadSourceType.OTHER_APPLICATION,ca=q.createClass({displayName:'NotificationBeeper',getInitialState:function(){return {soundEnabled:this.props.soundEnabled,hovering:false,fading:false,paused:false,pendingBeeps:{},renderedBeeps:{}};},componentWillMount:function(){var ea=i.getArbiterType('notif_sound_pref_changed'),fa='update-notifications';this.subscriptions=[o.subscribe(fa,function(ga,ha){if(ha.payloadsource===aa||ha.payloadsource===ba){var ia=ha.nodes;if(ia&&ia.length)this._handleBeepChanges(da(ia));}}.bind(this)),h.subscribe(ea,function(ga,ha){this.setState({soundEnabled:ha.obj.enabled});}.bind(this))];h.inform('NotificationBeeper/mounted',null,h.BEHAVIOR_PERSISTENT);},componentWillUnmount:function(){this.subscriptions.forEach(function(ea){ea.unsubscribe();});this.subscriptions=null;},_onMouseEnter:function(){if(this.state.paused)return;this._hideWait&&clearTimeout(this._hideWait);if(this.state.fading){this._animation.stop();this._animation=null;r.set(this.refs.container.getDOMNode(),'opacity','0.96');}var ea=Object.keys(this.state.renderedBeeps);if(this.props.unseenVsUnread){p.markNotificationsAsSeen(ea);}else p.markNotificationsAsRead(ea);this.setState({hovering:true,fading:false,pendingBeeps:{},renderedBeeps:u(this.state.renderedBeeps,this.state.pendingBeeps)});},_onMouseLeave:function(){if(this.state.paused)return;this._waitToHide(y);this.setState({hovering:false});},_onInsertedItem:function(ea){if(!this.state.hovering)this._waitToHide();if(this.state.soundEnabled&&ea.sound){if(!this._notifSound)this._notifSound=new n(this.props.soundPath);this._notifSound.play(ea.beepID);}if(this.props.shouldLogImpressions)l.log([ea.notificationID],z);},_waitToHide:function(ea){this._hideWait&&clearTimeout(this._hideWait);this._hideWait=v(w(this._hide,this),(ea||x)*(this.props.slowFade?2:1));},_hide:function(){this._animation&&this._animation.stop();this._animation=new g(this.refs.container.getDOMNode()).from('opacity','0.96').to('opacity','0').duration(1500).ondone(this._finishHide).go();this.setState({fading:true});},_finishHide:function(){var ea=this.state.pendingBeeps;this.setState({fading:false,pendingBeeps:{},renderedBeeps:{}});v(this.setState.bind(this,{renderedBeeps:ea},null));r.set(this.refs.container.getDOMNode(),'opacity','0.96');},_handleBeepChanges:function(ea){var fa=this.state.fading?this.state.pendingBeeps:this.state.renderedBeeps;Object.keys(ea).reverse().forEach(function(ga){var ha=ea[ga],ia=ha.beepID,ja=this.state.renderedBeeps[ga]||{};if(ja.beepID!=ia){delete fa[ga];fa[ga]=ha;}}.bind(this));if(!this.state.paused)this._waitToHide();this.forceUpdate();},_togglePause:function(){if(!this.state.paused){this._animation&&this._animation.stop();this._hideWait&&clearTimeout(this._hideWait);}else this._waitToHide();this.setState({paused:!this.state.paused});},render:function(){var ea=this.state.renderedBeeps,fa={};Object.keys(ea).reverse().forEach(function(ja){var ka=ea[ja];fa[ja]=j({beep:ka,onInserted:this._onInsertedItem});},this);var ga=!t(fa),ha=null;if(ga&&this.props.canPause)ha=q.DOM.li({className:"_a_g",onClick:this._togglePause},this.state.paused?'Continue':'Pause [fb]');var ia=((!ga?"hidden_elem":'')+(' '+"_50d1"));return (q.DOM.ul({ref:"container",className:ia,'data-gt':this.props.tracking,onMouseEnter:this._onMouseEnter,onMouseLeave:this._onMouseLeave},fa,ha));}});function da(ea){var fa={};ea.forEach(function(ga){if(!ga.showBeep)return;var ha=ga.alert_id,ia=ha+'-'+ga.receivedTime,ja=m.getThumbnail(ga.attachments,ga.attached_story);fa[ha]={notificationID:ha,beepID:ia,beepRenderer:ga.beepRenderer,actors:ga.actors,icon:ga.icon,link:ga.url,ajaxifyLink:ga.ajaxify_url,photo:ja,text:ga.unaggregatedTitle||ga.title,timestamp:ga.timestamp,receivedTime:ga.receivedTime,sound:!!ga.sound,tracking:ga.tracking};});return fa;}e.exports=ca;});
__d("NotificationXOut",["Arbiter","Event"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('Event');function i(m,n){g.inform('notif/negativeCancel',{id:m});n.kill();}function j(m){m.prevent();}function k(m,n){h.listen(m,'click',i.curry(n));}function l(m){h.listen(m,'click',j);}e.exports={setupCancelListener:k,setupNoListener:l};});
__d("LiveMessageReceiver",["Arbiter","ChannelConstants","copyProperties","emptyFunction","shield"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ChannelConstants'),i=b('copyProperties'),j=b('emptyFunction'),k=b('shield');function l(m){this.eventName=m;this.subs=null;this.handler=j;this.shutdownHandler=null;this.registered=false;this.appId=1;}i(l,{getAppMessageType:function(m,n){return 'live_message/'+m+':'+n;},route:function(m){var n=function(o){var p=l.getAppMessageType(m.app_id,m.event_name);g.inform(p,o,g.BEHAVIOR_PERSISTENT);};n(m.response);}});i(l.prototype,{setAppId:function(m){this.appId=m;return this;},setHandler:function(m){this.handler=m;this._dirty();return this;},setRestartHandler:j,setShutdownHandler:function(m){this.shutdownHandler=k(m);this._dirty();return this;},_dirty:function(){if(this.registered){this.unregister();this.register();}},register:function(){var m=function(o,p){return this.handler(p);}.bind(this),n=l.getAppMessageType(this.appId,this.eventName);this.subs={};this.subs.main=g.subscribe(n,m);if(this.shutdownHandler)this.subs.shut=g.subscribe(h.ON_SHUTDOWN,this.shutdownHandler);this.registered=true;return this;},unregister:function(){if(!this.subs)return this;for(var m in this.subs)if(this.subs[m])this.subs[m].unsubscribe();this.subs=null;this.registered=false;return this;}});e.exports=l;});
__d("initLiveMessageReceiver",["Arbiter","ChannelConstants","LiveMessageReceiver"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ChannelConstants'),i=b('LiveMessageReceiver');g.subscribe(h.getArbiterType('app_msg'),function(j,k){i.route(k.obj);});});